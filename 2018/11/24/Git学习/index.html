<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Hulk Lv"><title>Git学习 · Hulk Lv' Blog</title><meta name="description" content="Git是什么呢？
Git是目前最先进最好用的分布式版本控制系统。Git官网

分布式？
关于分布式，以及教程，我觉得廖老师写的很好，这是今天的链接：Git教程

Git的原理Git里面分为工作区和版本库，版本库里面的index就是暂存区stage，master是分支master所对应的master分"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">Hulk Lv' Blog</a></h3></div></div><ul class="social-links"></ul><div class="footer"><a href="https://github.com/xiaojiaolv131">GitHub </a><a href="http://weibo.com/u/1172318487"> WeiBo </a></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Git学习</a></h3></div><div class="post-content"><h1 id="Git是什么呢？"><a href="#Git是什么呢？" class="headerlink" title="Git是什么呢？"></a>Git是什么呢？</h1><blockquote>
<p>Git是目前最先进最好用的分布式版本控制系统。<br><a href="https://git-scm.com/" target="_blank" rel="external">Git官网</a></p>
</blockquote>
<h1 id="分布式？"><a href="#分布式？" class="headerlink" title="分布式？"></a>分布式？</h1><blockquote>
<p>关于分布式，以及教程，我觉得廖老师写的很好，这是今天的链接：<a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="external">Git教程</a></p>
</blockquote>
<h1 id="Git的原理"><a href="#Git的原理" class="headerlink" title="Git的原理"></a>Git的原理</h1><p><img src="/imgs/git1.jpeg" alt="Alt text"><br><br>Git里面分为工作区和版本库，版本库里面的index就是暂存区stage，master是分支master所对应的master分支目录树。HEAD是当前仓库指针，当进行<code>git add</code>时，是将工作区修改添加到暂存区，通过<code>commit</code>操作将暂存区内容提交到master分支，<code>reset HEAD</code>其实是将master分支回滚到暂存区，所以工作区是被保留的，不会被回滚的。当本地修改后，没有做任何提交，可以通过<code>checkout -- &lt;file&gt;</code>丢弃修改。<code>rm --cached</code>是从暂存区删除文件，工作区的文件不会被删除，工作区里面的文件需要进行<code>commit</code>才能被删除掉，也就是提交到master和stage里面。<code>checkout HEAD &lt;file&gt;</code>就是用HEAD指向的分支里面的文件替换暂存区和工作区，这个动作比较危险。</p>
<h1 id="记录一下常见的操作吧"><a href="#记录一下常见的操作吧" class="headerlink" title="记录一下常见的操作吧"></a>记录一下常见的操作吧</h1><h2 id="创建一个仓库"><a href="#创建一个仓库" class="headerlink" title="创建一个仓库"></a>创建一个仓库</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ mkdir git_test // 创建一个文件夹</div><div class="line">$ <span class="built_in">cd</span> git_test</div><div class="line">$ git init // 初始化该仓库</div></pre></td></tr></table></figure>
<p>这样我们可以看到文件夹下自动生成的隐藏的git文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ ll -a</div><div class="line"></div><div class="line">total 8</div><div class="line">drwxr-xr-x   4 lvxiaojiao  staff   128B 11 24 15:16 .</div><div class="line">drwxr-xr-x  63 lvxiaojiao  staff   2.0K 11 24 14:39 ..</div><div class="line">drwxr-xr-x  15 lvxiaojiao  staff   480B 11 24 15:31 .git</div></pre></td></tr></table></figure></p>
<h2 id="本地提交一个修改"><a href="#本地提交一个修改" class="headerlink" title="本地提交一个修改"></a>本地提交一个修改</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ vim demo1.js</div></pre></td></tr></table></figure>
<p>编辑并新建一个js文件，输入内容，比如某些开发内容<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'产品ABC'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ok，可以使用git status查看一下当前的git状态。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ git status</div><div class="line">// 红色文字提示的修改</div><div class="line">On branch master</div><div class="line">Changes not staged <span class="keyword">for</span> commit:</div><div class="line">  (use <span class="string">"git add &lt;file&gt;..."</span> to update what will be committed)</div><div class="line">  (use <span class="string">"git checkout -- &lt;file&gt;..."</span> to discard changes <span class="keyword">in</span> working directory)</div><div class="line"></div><div class="line">    modified:   demo1.js</div><div class="line"></div><div class="line">no changes added to commit (use <span class="string">"git add"</span> and/or <span class="string">"git commit -a"</span>)</div></pre></td></tr></table></figure></p>
<p>那么怎么使用git来提交代码呢？第一步，将修改内容添加到暂存区<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git add demo1.js</div></pre></td></tr></table></figure></p>
<p>可以使用git status查看一下当前的git状态<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ git status</div><div class="line">// 绿色文字提示的暂存区内容</div><div class="line">On branch master</div><div class="line">Changes to be committed:</div><div class="line">  (use <span class="string">"git reset HEAD &lt;file&gt;..."</span> to unstage)</div><div class="line"></div><div class="line">    modified:   demo1.js</div></pre></td></tr></table></figure></p>
<p>第二步，提交暂存内容<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git commit -m <span class="string">'add demo1.js'</span></div></pre></td></tr></table></figure></p>
<p>到了这一步，已经完成了将新建的demo1.js文件提交到本地master主干（自动生成的master分支）</p>
<h2 id="本地重置一个修改"><a href="#本地重置一个修改" class="headerlink" title="本地重置一个修改"></a>本地重置一个修改</h2><p>如果目前需要我们去修改代码，然而，还没等提交，PM又取消了刚刚的需求修改。比如，在工作区，我们对demo1.js文件进行如下修改<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ vim demo1.js</div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'产品ABC'</span>);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'需求1'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git add demo1.js</div></pre></td></tr></table></figure>
<p>ok，如之前的步骤一样，我们将新的修改放入暂存区，这时候需求变更需要回滚刚刚的修改<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ git reset --hard 46ee765 // 版本号前几位</div><div class="line"></div><div class="line">HEAD is now at 46ee765 add demo1.js</div></pre></td></tr></table></figure></p>
<p>这个时候再次打开文件的时候，已经恢复到之前的干净版本<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat demo1.js</div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">sayHello</span></span>() &#123;</div><div class="line">    console.log(<span class="string">'Hello!'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>廖老师的教程里面说的非常详细，Git的版本回退速度非常快，因为Git在内部有个指向当前版本的HEAD指针，当你回退版本的时候，Git仅仅是把HEAD从指向回退的位置，然后顺便把工作区的文件更新了。所以你让HEAD指向哪个版本号，你就把当前版本定位在哪。那如果PM又说刚刚的修改还是保留吧，但是之前的commit id忘了怎么办？<br>在Git中，总是有后悔药可以吃的。当你用<code>$ git reset --hard HEAD^</code>回退到“产品ABC”版本时，再想恢复到“需求1”，就必须找到“需求1”的commit id。Git提供了一个命令<code>git reflog</code>用来记录你的每一次命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git reflog</div></pre></td></tr></table></figure></p>
<p>总结一下：<br><code>HEAD</code>指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令<code>git reset --hard commit_id</code>。<br>穿梭前，用<code>git log</code>可以查看提交历史，以便确定要回退到哪个版本。<br>要重返未来，用<code>git reflog</code>查看命令历史，以便确定要回到未来的哪个版本</p>
<p>重置以后，PM提出正确的需求，我们进行修改和提交<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'产品ABC'</span>);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'需求2'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git add demo1.js</div><div class="line">$ git commit -m <span class="string">'需求2'</span></div></pre></td></tr></table></figure>
<p>这样就又一次提交了代码的变更，然而，此时PM发现刚才提出的需求是没用的，需要直接干掉。<br>如果使用sourceTree，可以选中“产品ABC”的那次提交，选中<code>将master提交到这次提交</code>，这时发现“需求2”的修改已经回到未暂存区（此时文件的本地修改是存在的），选中该文件选择<code>丢弃文件</code>，然后“需求2”的修改被重置到之前的状态“产品ABC”<br>如果使用git命令，可以:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ git reset 46ee7653486d8456d3b96a27618ce3517fce7da0 demo1.js // git reset HEAD demo1.js产品ABC的提交</div><div class="line">Unstaged changes after reset:</div><div class="line">M   demo1.js</div></pre></td></tr></table></figure></p>
<p>reset之后，此时本地的修改回退到工作区，不加–hard的reset是回滚代码，并保留之前的修改，使用hard是仓库和暂存区都进行回滚。如果想丢弃修改，可以这样<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git checkout -- demo1.js // 如果git checkout .则丢弃所有修改</div></pre></td></tr></table></figure></p>
<p>这样就回到干净的“产品ABC”提交了。此时PM提出这个需求全部作废，那么需要干掉demo1.js文件，可以<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ git rm demo1.js // 如果git checkout .则丢弃所有修改</div><div class="line">rm <span class="string">'demo1.js'</span></div><div class="line">$ git status</div><div class="line">On branch master</div><div class="line">Changes to be committed:</div><div class="line">  (use <span class="string">"git reset HEAD &lt;file&gt;..."</span> to unstage)</div><div class="line"></div><div class="line">    deleted:    demo1.js</div></pre></td></tr></table></figure></p>
<p>此时，工作区的文件已经清空了，但是暂存区里面还有demo1.js<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ git commit -m <span class="string">'delete'</span></div><div class="line">[master 2aa91ad] delete</div><div class="line"> 1 file changed, 4 deletions(-)</div><div class="line"> delete mode 100644 demo1.js</div></pre></td></tr></table></figure></p>
<p>此时，工作区和暂存区的文件都被清空了。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-11-24</span><i class="fa fa-tag"></i></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://yoursite.com/2018/11/24/Git学习/,Hulk Lv' Blog,Git学习,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2018/11/24/webpack入门/" title="webpack入门" class="btn">上一篇</a></li><li class="next pagbuttons"><a role="navigation" href="/2018/03/19/三日游江苏/" title="三日游江苏" class="btn">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>