<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Hulk Lv"><title>移动端实现菜单栏滚动置顶和点击置顶 · Hulk Lv' Blog</title><meta name="description" content="在很多APP上，我们经常能见到菜单滚动置顶、点击置顶的场景，说的通俗一点就是：起初页面初始化的时候，菜单处于文档流中，当我们向上滑动页面的时候，菜单脱离文档流，悬浮于页面顶端，且将一直处于顶端，而当我们向下滑动页面的至最初的位置时，菜单又回到文档流当中了。

滚动置顶的思路
要想让菜单固定在顶端，我"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">Hulk Lv' Blog</a></h3></div></div><ul class="social-links"></ul><div class="footer"><a href="https://github.com/xiaojiaolv131">GitHub </a><a href="http://weibo.com/u/1172318487"> WeiBo </a></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>移动端实现菜单栏滚动置顶和点击置顶</a></h3></div><div class="post-content"><blockquote>
<p>在很多APP上，我们经常能见到菜单滚动置顶、点击置顶的场景，说的通俗一点就是：起初页面初始化的时候，菜单处于文档流中，当我们向上滑动页面的时候，菜单脱离文档流，悬浮于页面顶端，且将一直处于顶端，而当我们向下滑动页面的至最初的位置时，菜单又回到文档流当中了。</p>
</blockquote>
<h3 id="滚动置顶的思路"><a href="#滚动置顶的思路" class="headerlink" title="滚动置顶的思路"></a>滚动置顶的思路</h3><blockquote>
<p>要想让菜单固定在顶端，我们想到的当然是<code>position:fixed</code>啦~ 上代码来试试：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">    &lt;div class="mod-page js-body"&gt;</div><div class="line">        &lt;section class="mod-content js-mod-body index"&gt;</div><div class="line">            &lt;!--省略部分结构--&gt;</div><div class="line">            &lt;div class="mod-filter bc-main com-space" id="menuNav" :style="&#123;'height':menuHeight + 'px'&#125;"&gt;</div><div class="line">                &lt;div class="mod-filter bc-main" :class="&#123;'fixed-menu-fixed': isFixedMenu&#125;" id="topMenu"&gt;</div><div class="line">                    &lt;nav class="filter-nav"&gt;</div><div class="line">                        &lt;ul class="mod-list mod-flex com-border-bottom"&gt;</div><div class="line">                            &lt;li class="mod-list-item mod-flex-item" v-for="item in filterData"&gt;</div><div class="line">                                &lt;a href="javascript:;" class="mod-list-info"&gt;&#123;&#123;item&#125;&#125;&lt;/a&gt;</div><div class="line">                            &lt;/li&gt;</div><div class="line">                        &lt;/ul&gt;</div><div class="line">                    &lt;/nav&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;!--省略部分结构--&gt;</div><div class="line">        &lt;/section&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/template&gt;</div><div class="line">&lt;script&gt;</div><div class="line">    import scrollTo from 'scrollTo.js'</div><div class="line">    export default &#123;</div><div class="line">        data () &#123;</div><div class="line">            return &#123;</div><div class="line">                filterData: ["区域", "职位类型", "职位排序", "筛选"],</div><div class="line">                platform: Util.OS(),</div><div class="line">                isFixedMenu: false, //是否Fixed menu</div><div class="line">                menuTop: 48, // menu固定top</div><div class="line">                menuHeight: 44 // menu高度</div><div class="line">                threshold: 100</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        methods: &#123;</div><div class="line">            /**</div><div class="line">             * 初始化</div><div class="line">             * @method initFun</div><div class="line">             * @public</div><div class="line">             * @return &#123;Null&#125; void</div><div class="line">             */</div><div class="line">            initFun() &#123;</div><div class="line">                let self = this;</div><div class="line">                //注册滚动事件</div><div class="line">                self.registerScrollEvent();</div><div class="line">            &#125;,</div><div class="line">            /**</div><div class="line">             * 注册滚动事件，用以实现menu固定</div><div class="line">             * @method registerScrollEvent</div><div class="line">             * @public</div><div class="line">             * @return &#123;Null&#125; void</div><div class="line">             */</div><div class="line">            registerScrollEvent () &#123;</div><div class="line">                let self = this;</div><div class="line">                $(document).on('scroll', function(e) &#123;</div><div class="line">                    let scrolltop = document.body.scrollTop;</div><div class="line">                    if( scrolltop &gt;= threshold) &#123;</div><div class="line">                        self.isFixedMenu = true;</div><div class="line">                    &#125; else if (scrolltop &lt; threshold + menuHeight) &#123;</div><div class="line">                        self.isFixedMenu = false;</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        created() &#123;</div><div class="line">            let self = this;</div><div class="line">            self.initFun();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;!--省略部分样式--&gt;</div><div class="line">&lt;style src="static/css/test.css"&gt;&lt;/style&gt;</div><div class="line">&lt;style type="text/css"&gt;</div><div class="line">.fixed-menu-fixed &#123;</div><div class="line">    animation: fade-in .3s;</div><div class="line">    position: fixed !important;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@keyframes fade-in &#123;</div><div class="line">        0% &#123;</div><div class="line">            opacity: 0;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        10% &#123;</div><div class="line">            opacity: 0.1;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        20% &#123;</div><div class="line">            opacity: 0.2;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        30% &#123;</div><div class="line">            opacity: 0.3;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        40% &#123;</div><div class="line">            opacity: 0.4;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        50% &#123;</div><div class="line">            opacity: 0.5;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        60% &#123;</div><div class="line">            opacity: 0.6;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        70% &#123;</div><div class="line">            opacity: 0.7;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        80% &#123;</div><div class="line">            opacity: 0.8;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        90% &#123;</div><div class="line">            opacity: 0.9;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        100% &#123;</div><div class="line">            opacity: 1;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure></p>
<p>我们通过监听页面的滚动<code>scroll</code>事件，在滚动事件回调中判断菜单滚动位置是否超出阀值<code>threshold</code>，如果超出阀值则设置成固定布局<code>position: fixed</code>(脱离文档流)，如果小于阀值+菜单高度，则恢复原有布局(回到文档流),经过试验，安卓手机上是没问题的，需要注意的是：使用<code>position: fixed</code>会使页面中菜单脱离文档流，那么将影响它下面的DOM结构，出现突然抖动上移的情况，对于这种情况，我们需要做<code>占位</code>处理，即给菜单套一层有固定高度(menuHeight)的div。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mod-page js-body"</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"mod-content js-mod-body index"</span>&gt;</span></div><div class="line">            <span class="comment">&lt;!--省略部分结构--&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mod-filter bc-main com-space"</span> <span class="attr">id</span>=<span class="string">"menuNav"</span> <span class="attr">:style</span>=<span class="string">"&#123;'height':menuHeight + 'px'&#125;"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mod-filter bc-main"</span> <span class="attr">:class</span>=<span class="string">"&#123;'fixed-menu-fixed': isFixedMenu&#125;"</span> <span class="attr">id</span>=<span class="string">"topMenu"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"filter-nav"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"mod-list mod-flex com-border-bottom"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"mod-list-item mod-flex-item"</span> <span class="attr">v-for</span>=<span class="string">"item in filterData"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:;"</span> <span class="attr">class</span>=<span class="string">"mod-list-info"</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="comment">&lt;!--省略部分结构--&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">&lt;<span class="regexp">/template&gt;</span></div></pre></td></tr></table></figure></p>
<p>但是对于ios来说，只能在滚动结束后才会触发<code>scroll</code>回调，即便监听’touchmove’实时触发滚动回调，对于菜单布局的渲染也是阻塞的，也就是会延迟很多。。。，多么尴尬的岁月~多么尴尬的日子~多么尴尬~好想改变一切~只是没有银子但有方法，哈哈！下面隆重介绍一下粘性布局<code>position: sticky</code>。</p>
</blockquote>
<h3 id="粘性布局（position-sticky）"><a href="#粘性布局（position-sticky）" class="headerlink" title="粘性布局（position: sticky）"></a>粘性布局（position: sticky）</h3><blockquote>
<p>网络上关于粘性布局（position: sticky）的博客很多，这里引用一下地址（本人太懒，O(∩_∩)O）：<br><a href="http://www.cnblogs.com/coco1s/p/6402723.html" target="_blank" rel="external">使用 position:sticky 实现粘性布局</a><br><a href="http://www.tuicool.com/articles/bi6J7nY" target="_blank" rel="external">position:sticky实现iOS6+下的粘性布局</a></p>
<p>好了，了解了粘性布局（position: sticky）之后，我们对代码进行了修改：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">    &lt;div class="mod-page js-body"&gt;</div><div class="line">        &lt;section class="mod-content js-mod-body index"&gt;</div><div class="line">            &lt;!--省略部分结构--&gt;</div><div class="line">            &lt;div class="mod-filter bc-main com-space" id="menuNav" :style="&#123;'height':menuHeight + 'px'&#125;" v-if="platform == 'android'"&gt;</div><div class="line">                &lt;div class="mod-filter bc-main" :class="&#123;'fixed-menu-fixed': isFixedMenu&#125;" id="topMenu"&gt;</div><div class="line">                    &lt;nav class="filter-nav"&gt;</div><div class="line">                        &lt;ul class="mod-list mod-flex com-border-bottom"&gt;</div><div class="line">                            &lt;li class="mod-list-item mod-flex-item" v-for="item in filterData"&gt;</div><div class="line">                                &lt;a href="javascript:;" class="mod-list-info"&gt;&#123;&#123;item&#125;&#125;&lt;/a&gt;</div><div class="line">                            &lt;/li&gt;</div><div class="line">                        &lt;/ul&gt;</div><div class="line">                    &lt;/nav&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;div class="mod-filter bc-main com-space" :class="&#123;'fixed-menu-sticky': isStickyMenu, 'active': clickedMenuItem != -1&#125;" id="menuNav" v-if="platform == 'ios'"&gt;</div><div class="line">                &lt;nav class="filter-nav"&gt;</div><div class="line">                    &lt;ul class="mod-list mod-flex com-border-bottom"&gt;</div><div class="line">                        &lt;li class="mod-list-item mod-flex-item" v-for="(item, index) in filterData" @click="filterMenuClicked()"&gt;</div><div class="line">                            &lt;a href="javascript:;" class="mod-list-info"&gt;&#123;&#123;item&#125;&#125;&lt;/a&gt;</div><div class="line">                        &lt;/li&gt;</div><div class="line">                    &lt;/ul&gt;</div><div class="line">                &lt;/nav&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;!--省略部分结构--&gt;</div><div class="line">        &lt;/section&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/template&gt;</div><div class="line">&lt;script&gt;</div><div class="line">    import scrollTo from 'scrollTo.js'</div><div class="line">    export default &#123;</div><div class="line">        data () &#123;</div><div class="line">            return &#123;</div><div class="line">                filterData: ["区域", "职位类型", "职位排序", "筛选"],</div><div class="line">                platform: Util.OS(),</div><div class="line">                isFixedMenu: false, //是否Fixed menu</div><div class="line">                isStickyMenu: false, //是否Sticky menu</div><div class="line">                menuTop: 48, // menu固定top</div><div class="line">                menuHeight: 44 // menu高度</div><div class="line">                threshold: 100</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        methods: &#123;</div><div class="line">            /**</div><div class="line">             * 初始化</div><div class="line">             * @method initFun</div><div class="line">             * @public</div><div class="line">             * @return &#123;Null&#125; void</div><div class="line">             */</div><div class="line">            initFun() &#123;</div><div class="line">                let self = this;</div><div class="line">                //注册滚动事件</div><div class="line">                self.registerScrollEvent();</div><div class="line">            &#125;,</div><div class="line">            /**</div><div class="line">             * 注册滚动事件，用以实现menu固定</div><div class="line">             * @method registerScrollEvent</div><div class="line">             * @public</div><div class="line">             * @return &#123;Null&#125; void</div><div class="line">             */</div><div class="line">            registerScrollEvent () &#123;</div><div class="line">                let self = this;</div><div class="line">                /*##############主要看这里###################*/</div><div class="line">                let menuId = 'topMenu';</div><div class="line">                if(Util.OS() == 'ios') &#123;</div><div class="line">                    menuId = 'menuNav';</div><div class="line">                &#125;</div><div class="line">                // 设置菜单的top位置</div><div class="line">                $(`#$&#123;menuId&#125;`).css('top', self.menuTop + 'px');</div><div class="line">                if(/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent))&#123;</div><div class="line">                    self.isStickyMenu = true;</div><div class="line">                &#125; else if (/android/i.test(navigator.userAgent)) &#123;</div><div class="line">                    $(document).on('scroll', function(e) &#123;</div><div class="line">                        let scrolltop = document.body.scrollTop;</div><div class="line">                        if(/android/i.test(navigator.userAgent))&#123;</div><div class="line">                            if( scrolltop &gt;= threshold) &#123;</div><div class="line">                                self.isFixedMenu = true;</div><div class="line">                            &#125; else if (scrolltop &lt; threshold + menuHeight) &#123;</div><div class="line">                                self.isFixedMenu = false;</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    &#125;);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            filterMenuClicked () &#123;</div><div class="line">                let self = this;</div><div class="line">                $('body').scrollTo(&#123;toT: self.menuTop, durTime : 200&#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        created() &#123;</div><div class="line">            let self = this;</div><div class="line">            self.initFun();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;!--省略部分样式--&gt;</div><div class="line">&lt;style src="static/css/test.css"&gt;&lt;/style&gt;</div><div class="line">&lt;style type="text/css"&gt;</div><div class="line">.fixed-menu-fixed &#123;</div><div class="line">    animation: fade-in .3s;</div><div class="line">    position: fixed !important;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*##############主要看这里###################*/</div><div class="line">.fixed-menu-sticky &#123; </div><div class="line">    position: -webkit-sticky !important;</div><div class="line">    position: -moz-sticky !important;</div><div class="line">    position: -ms-sticky !important;</div><div class="line">    position: -o-sticky !important;</div><div class="line">    position: sticky !important;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@keyframes fade-in &#123;</div><div class="line">        0% &#123;</div><div class="line">            opacity: 0;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        10% &#123;</div><div class="line">            opacity: 0.1;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        20% &#123;</div><div class="line">            opacity: 0.2;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        30% &#123;</div><div class="line">            opacity: 0.3;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        40% &#123;</div><div class="line">            opacity: 0.4;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        50% &#123;</div><div class="line">            opacity: 0.5;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        60% &#123;</div><div class="line">            opacity: 0.6;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        70% &#123;</div><div class="line">            opacity: 0.7;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        80% &#123;</div><div class="line">            opacity: 0.8;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        90% &#123;</div><div class="line">            opacity: 0.9;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        100% &#123;</div><div class="line">            opacity: 1;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure></p>
<p>因为安卓手机需要一个占位，而ios不需要，所以我们分开处理。在<code>registerScrollEvent</code>方法中，我们首先判断是ios设备还是安卓设备，如果是ios设备，我们直接使用<code>position: sticky;</code>来将菜单设置成粘性布局，并给它一个top值，这个值表示当元素距离页面视口（Viewport，也就是fixed定位的参照）顶部距离大于 0px 时，元素以 relative 定位表现，而当元素距离页面视口小于 0px 时，元素表现为 fixed 定位，也就会固定在顶部。</p>
</blockquote>
<h3 id="实现点击滚动置顶"><a href="#实现点击滚动置顶" class="headerlink" title="实现点击滚动置顶"></a>实现点击滚动置顶</h3><blockquote>
<p>思路很简单，就是点击菜单项，将页面滚动至我们设定的位置。我们前端采用的是zepto这个轻库进行开发的，因此想采用animate({scrollTop:”100px”})函数进行页面的动画滚动，结果就是毫无效果。。。，发现zepto的animate()源码采用css3的方式进行，而scrollTop属性不在css3的动画属性中，所以没有生效。接下来的方法就是自己写一个滚动条上下滚动的方法。那么，我们来写一写：。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* scrollTo.js */</span></div><div class="line">$.fn.scrollTo =<span class="function"><span class="keyword">function</span>(<span class="params">options</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> defaults = &#123;</div><div class="line">        <span class="attr">toT</span> : <span class="number">0</span>,    <span class="comment">//滚动目标位置</span></div><div class="line">        durTime : <span class="number">500</span>,  <span class="comment">//过渡动画时间</span></div><div class="line">        delay : <span class="number">30</span>,     <span class="comment">//定时器时间</span></div><div class="line">        callback:<span class="literal">null</span>   <span class="comment">//回调函数</span></div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">var</span> opts = $.extend(defaults,options),</div><div class="line">        timer = <span class="literal">null</span>,</div><div class="line">        _this = <span class="keyword">this</span>,</div><div class="line">        curTop = _this.scrollTop(),<span class="comment">//滚动条当前的位置</span></div><div class="line">        subTop = opts.toT - curTop,    <span class="comment">//滚动条目标位置和当前位置的差值</span></div><div class="line">        index = <span class="number">0</span>,</div><div class="line">        dur = <span class="built_in">Math</span>.round(opts.durTime / opts.delay),</div><div class="line">        smoothScroll = <span class="function"><span class="keyword">function</span>(<span class="params">t</span>)</span>&#123;</div><div class="line">            index++;</div><div class="line">            <span class="keyword">var</span> per = <span class="built_in">Math</span>.round(subTop/dur);</div><div class="line">            <span class="keyword">if</span>(index &gt;= dur)&#123;</div><div class="line">                _this.scrollTop(t);</div><div class="line">                <span class="built_in">window</span>.clearInterval(timer);</div><div class="line">                <span class="keyword">if</span>(opts.callback &amp;&amp; <span class="keyword">typeof</span> opts.callback == <span class="string">'function'</span>)&#123;</div><div class="line">                    opts.callback();</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                _this.scrollTop(curTop + index*per);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">    timer = <span class="built_in">window</span>.setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        smoothScroll(opts.toT);</div><div class="line">    &#125;, opts.delay);</div><div class="line">    <span class="keyword">return</span> _this;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>采用原型函数的方式，制做一个scrollTo方，效果还不错~~哈！然后，我们给菜单项绑定点击事件<code>filterMenuClicked</code>，在<code>filterMenuClicked</code>中实现点击滚动置顶。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">    &lt;div class="mod-page js-body"&gt;</div><div class="line">        &lt;section class="mod-content js-mod-body index"&gt;</div><div class="line">            &lt;!--省略部分结构--&gt;</div><div class="line">            &lt;div class="mod-filter bc-main com-space" id="menuNav" :style="&#123;'height':menuHeight + 'px'&#125;" v-if="platform == 'android'"&gt;</div><div class="line">                &lt;div class="mod-filter bc-main" :class="&#123;'fixed-menu-fixed': isFixedMenu&#125;" id="topMenu"&gt;</div><div class="line">                    &lt;nav class="filter-nav"&gt;</div><div class="line">                        &lt;ul class="mod-list mod-flex com-border-bottom"&gt;</div><div class="line">                            &lt;li class="mod-list-item mod-flex-item" v-for="item in filterData"&gt;</div><div class="line">                                &lt;a href="javascript:;" class="mod-list-info"&gt;&#123;&#123;item&#125;&#125;&lt;/a&gt;</div><div class="line">                            &lt;/li&gt;</div><div class="line">                        &lt;/ul&gt;</div><div class="line">                    &lt;/nav&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;div class="mod-filter bc-main com-space" :class="&#123;'fixed-menu-sticky': isStickyMenu, 'active': clickedMenuItem != -1&#125;" id="menuNav" v-if="platform == 'ios'"&gt;</div><div class="line">                &lt;nav class="filter-nav"&gt;</div><div class="line">                    &lt;ul class="mod-list mod-flex com-border-bottom"&gt;</div><div class="line">                        &lt;li class="mod-list-item mod-flex-item" v-for="(item, index) in filterData" @click="filterMenuClicked()"&gt;</div><div class="line">                            &lt;a href="javascript:;" class="mod-list-info"&gt;&#123;&#123;item&#125;&#125;&lt;/a&gt;</div><div class="line">                        &lt;/li&gt;</div><div class="line">                    &lt;/ul&gt;</div><div class="line">                &lt;/nav&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;!--省略部分结构--&gt;</div><div class="line">        &lt;/section&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/template&gt;</div><div class="line">&lt;script&gt;</div><div class="line">    import scrollTo from 'scrollTo.js'</div><div class="line">    export default &#123;</div><div class="line">        data () &#123;</div><div class="line">            return &#123;</div><div class="line">                filterData: ["区域", "职位类型", "职位排序", "筛选"],</div><div class="line">                platform: Util.OS(),</div><div class="line">                isFixedMenu: false, //是否Fixed menu</div><div class="line">                isStickyMenu: false, //是否Sticky menu</div><div class="line">                menuTop: 48, // menu固定top</div><div class="line">                menuHeight: 44 // menu高度</div><div class="line">                threshold: 100</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        methods: &#123;</div><div class="line">            /**</div><div class="line">             * 初始化</div><div class="line">             * @method initFun</div><div class="line">             * @public</div><div class="line">             * @return &#123;Null&#125; void</div><div class="line">             */</div><div class="line">            initFun() &#123;</div><div class="line">                let self = this;</div><div class="line">                //注册滚动事件</div><div class="line">                self.registerScrollEvent();</div><div class="line">            &#125;,</div><div class="line">            /**</div><div class="line">             * 注册滚动事件，用以实现menu固定</div><div class="line">             * @method registerScrollEvent</div><div class="line">             * @public</div><div class="line">             * @return &#123;Null&#125; void</div><div class="line">             */</div><div class="line">            registerScrollEvent () &#123;</div><div class="line">                let self = this;</div><div class="line">                if(/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent))&#123;</div><div class="line">                    self.isStickyMenu = true;</div><div class="line">                &#125; else if (/android/i.test(navigator.userAgent)) &#123;</div><div class="line">                    $(document).on('scroll', function(e) &#123;</div><div class="line">                        let scrolltop = document.body.scrollTop;</div><div class="line">                        if(/android/i.test(navigator.userAgent))&#123;</div><div class="line">                            if( scrolltop &gt;= threshold) &#123;</div><div class="line">                                self.isFixedMenu = true;</div><div class="line">                            &#125; else if (scrolltop &lt; threshold + menuHeight) &#123;</div><div class="line">                                self.isFixedMenu = false;</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    &#125;);</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            filterMenuClicked () &#123;</div><div class="line">                let self = this;</div><div class="line">                /*##############主要看这里###################*/</div><div class="line">                $('body').scrollTo(&#123;toT: self.menuTop, durTime : 200&#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        created() &#123;</div><div class="line">            let self = this;</div><div class="line">            self.initFun();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;!--省略部分样式--&gt;</div><div class="line">&lt;style src="static/css/test.css"&gt;&lt;/style&gt;</div><div class="line">&lt;style type="text/css"&gt;</div><div class="line">.fixed-menu-fixed &#123;</div><div class="line">    animation: fade-in .3s;</div><div class="line">    position: fixed !important;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.fixed-menu-sticky &#123; </div><div class="line">    position: -webkit-sticky !important;</div><div class="line">    position: -moz-sticky !important;</div><div class="line">    position: -ms-sticky !important;</div><div class="line">    position: -o-sticky !important;</div><div class="line">    position: sticky !important;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@keyframes fade-in &#123;</div><div class="line">        0% &#123;</div><div class="line">            opacity: 0;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        10% &#123;</div><div class="line">            opacity: 0.1;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        20% &#123;</div><div class="line">            opacity: 0.2;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        30% &#123;</div><div class="line">            opacity: 0.3;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        40% &#123;</div><div class="line">            opacity: 0.4;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        50% &#123;</div><div class="line">            opacity: 0.5;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        60% &#123;</div><div class="line">            opacity: 0.6;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        70% &#123;</div><div class="line">            opacity: 0.7;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        80% &#123;</div><div class="line">            opacity: 0.8;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        90% &#123;</div><div class="line">            opacity: 0.9;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        100% &#123;</div><div class="line">            opacity: 1;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure></p>
<p>好啦，先记录到这儿吧</p>
</blockquote>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-09-19</span><i class="fa fa-tag"></i><a href="/tags/Vue-js/" title="Vue.js" class="tag">Vue.js </a><a href="/tags/移动端/" title="移动端" class="tag">移动端 </a><a href="/tags/粘性布局/" title="粘性布局" class="tag">粘性布局 </a><a href="/tags/position/" title="position" class="tag">position </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://yoursite.com/2017/09/19/移动端实现菜单栏滚动置顶和点击置顶/,Hulk Lv' Blog,移动端实现菜单栏滚动置顶和点击置顶,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2017/09/25/学习正则表达式/" title="学习正则表达式" class="btn">上一篇</a></li><li class="next pagbuttons"><a role="navigation" href="/2017/09/14/进军长白山/" title="进军长白山" class="btn">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>